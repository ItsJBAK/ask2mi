<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AskMi ‚Äî Llama Float Edition</title>
  <link rel="icon" type="image/png" href="kuzco.png" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap" rel="stylesheet">
  <style>
    html, body { 
      margin:0; padding:0; height:100%; overflow:hidden; 
      background:#000; font-family:'Orbitron', Arial, sans-serif; 
    }

    /* üåå Starfield background */
    .starfield {
      position:fixed; inset:0; width:100vw; height:100vh;
      z-index:0; pointer-events:none;
    }
    .starfield-origin { position:absolute; top:50%; left:50%; width:1px; height:1px; transform:translate(-50%, -50%); opacity:0; }

    /* Modal & UI */
    .modal{
      position:fixed; left:50%; top:50%; transform:translate(-50%,-50%);
      width:90%; max-width:420px;
      background:#1c2a3a; border:2px solid #e0b22a; border-radius:12px;
      padding:30px 24px; box-shadow:0 8px 20px rgba(0,0,0,.6);
      z-index:2; animation:pulse 2s infinite;
    }
    .modal h2{ margin:0 0 8px; color:#e0b22a; text-align:center; }
    .modal p{ color:#ccc; text-align:center; }

    textarea{ 
      width:100%; height:100px; margin:16px 0; box-sizing:border-box; 
      font-family: Arial, sans-serif;
    }
    textarea::placeholder {
      font-family: 'Orbitron', Arial, sans-serif;
      letter-spacing: 0.5px;
    }

    button{ 
      background:#e0b22a; color:#1c2a3a; border:0; padding:12px 24px; 
      border-radius:6px; cursor:pointer; font-weight:700; 
      font-family: 'Orbitron', Arial, sans-serif;
    }
    button:hover{ background:#f2c849; }

    .thanks{ display:none; color:#90ee90; text-align:center; font-weight:700; }
    .footer{ position:fixed; bottom:10px; left:0; right:0; text-align:center; color:#888; z-index:2; }

    @keyframes pulse{0%{box-shadow:0 0 8px #e0b22a}50%{box-shadow:0 0 20px #e0b22a}100%{box-shadow:0 0 8px #e0b22a}}

    /* ü¶ô Floating Kuzcos */
    .llama-float{
      position:absolute; width:60px; z-index:1; pointer-events:none; opacity:.9; animation:floatLlama linear infinite;
    }
    @keyframes floatLlama{
      0%{ transform:translateY(100vh) rotate(0deg); opacity:0 }
      10%{ opacity:1 } 
      100%{ transform:translateY(-120vh) rotate(360deg); opacity:0 }
    }
  </style>
</head>
<body>

  <!-- Starfield background -->
  <div class="starfield"><div class="starfield-origin"></div></div>

  <div class="modal">
    <h2>AskMi üññ</h2>
    <p>Got a galactic question for Mimi? Type it below and beam it up.</p>
    <div class="input-area">
      <textarea id="userQuestion" placeholder="Type your question here..."></textarea>
      <button onclick="submitQuestion()">Send to Mimi</button>
    </div>
    <div class="thanks" id="thanksMsg">‚úÖ Your question was transmitted to the ship.</div>
  </div>

  <div class="footer">üõ∞Ô∏è Part of the MIMI newsletter experience ‚Äî Llama Space Edition.</div>

  <script>
    // ü¶ô floating llamas
    const kuzcoCount = 6;
    for (let i = 0; i < kuzcoCount; i++) {
      const llama = document.createElement("img");
      llama.src = "kuzco.png";
      llama.className = "llama-float";
      llama.style.left = `${Math.random() * 100}%`;
      llama.style.animationDuration = `${10 + Math.random() * 10}s`;
      llama.style.animationDelay = `${Math.random() * 5}s`;
      document.body.appendChild(llama);
    }

    async function submitQuestion() {
      const button = document.querySelector("button");
      const textarea = document.getElementById("userQuestion");
      const thanksMsg = document.getElementById("thanksMsg");
      const question = textarea.value.trim();

      if (!question) { 
        alert("Please enter a question."); 
        return; 
      }

      button.disabled = true; 
      button.innerText = "Sending...";

      // üöÄ Smooth warp-speed: ease in, hold, ease out
      let accel = 0;
      const easeIn = setInterval(() => {
        accel += 0.1;
        if (accel >= 1) {
          accel = 1;
          clearInterval(easeIn);
          setTimeout(() => {
            const easeOut = setInterval(() => {
              accel -= 0.1;
              if (accel <= 0) {
                accel = 0;
                clearInterval(easeOut);
              }
              Starfield.accelerate(accel);
            }, 60);
          }, 2000); // hold warp for 2s
        }
        Starfield.accelerate(accel);
      }, 60);

      try {
        const r = await fetch('https://ask2mi-backend.onrender.com/ask', {
          method: 'POST', 
          headers: {'Content-Type':'application/json'}, 
          body: JSON.stringify({ question })
        });
        if (r.ok) { 
          textarea.style.display='none'; 
          button.style.display='none'; 
          thanksMsg.style.display='block'; 
        } else { 
          throw new Error("Bad response"); 
        }
      } catch {
        alert("Network error. Please try again.");
        button.disabled = false; 
        button.innerText = "Send to Mimi";
      }
    }
  </script>

  <!-- Starfield lib -->
  <script src="https://cdn.jsdelivr.net/gh/AnnikaV9/starfield.js@1.5.0/starfield.js"></script>
  <script>
    Starfield.setup({
      starColor: "rgb(230,230,255)",
      canvasColor: "rgb(0,0,10)",
      trailLength: 0.8,
      baseSpeed: 3,
      maxAcceleration: 2,
      accelerationRate: 0.05,
      decelerationRate: 0.05,
      minSpawnRadius: 80,
      maxSpawnRadius: 500
    });
  </script>
</body>
</html>

